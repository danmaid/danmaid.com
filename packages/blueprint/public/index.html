<!DOCTYPE html>
<html>
  <head>
    <title>Page Title</title>
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <style>
      :root {
        background-color: #000;
        color: #eee;
      }
    </style>
  </head>
  <body style="display: flex; flex-direction: column; height: 100vh; margin: 0; padding: 8px; box-sizing: border-box">
    <div
      id="out"
      style="flex: 1 0; background-color: #00f3; display: flex; flex-direction: column-reverse; overflow: auto"
    ></div>
    <div id="in" style="flex: 0 0; background-color: #0f03">
      <input />
      <div>x</div>
      <div>y</div>
      <div>z</div>
    </div>

    <div style="position: absolute; top: 0; right: 0">
      <button onclick="start()">start</button>
      <button onclick="stop()">stop</button>
      <button onclick="clearOut()">clear</button>
    </div>

    <script>
      class EventSourceStub extends EventTarget {
        constructor() {
          super()
          this.addEventListener('message', (...args) => this.onmessage(...args))
        }
        onmessage() {}
        emit(data) {
          const event = new MessageEvent('message', { data: JSON.stringify(data) })
          return this.dispatchEvent(event)
        }
      }

      let timer
      function start() {
        stop()
        timer = setInterval(() => src.emit({ date: new Date() }), 500)
      }
      function stop() {
        clearInterval(timer)
      }
      function clearOut() {
        out.innerHTML = ''
      }
    </script>
    <script>
      // const src = new EventSource('/')
      const src = new EventSourceStub()

      const out = document.getElementById('out')
      src.onmessage = (ev) => {
        const div = document.createElement('div')
        div.textContent = ev.data
        out.append(div)
      }
    </script>
  </body>
</html>
